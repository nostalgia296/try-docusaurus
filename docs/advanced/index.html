<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-advanced" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>高级主题 | GitHub Release Manager</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://github.com/try-docusaurus/img/docusaurus-social-card.jpg /><meta data-rh=true name=twitter:image content=https://github.com/try-docusaurus/img/docusaurus-social-card.jpg /><meta data-rh=true property=og:url content=https://github.com/try-docusaurus/docs/advanced /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="高级主题 | GitHub Release Manager"/><meta data-rh=true name=description content="本文档介绍 GitHub Release Manager 的高级用法和最佳实践。"/><meta data-rh=true property=og:description content="本文档介绍 GitHub Release Manager 的高级用法和最佳实践。"/><link data-rh=true rel=icon href=/try-docusaurus/img/favicon.ico /><link data-rh=true rel=canonical href=https://github.com/try-docusaurus/docs/advanced /><link data-rh=true rel=alternate href=https://github.com/try-docusaurus/docs/advanced hreflang=en /><link data-rh=true rel=alternate href=https://github.com/try-docusaurus/docs/advanced hreflang=x-default /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://github.com/try-docusaurus/docs/advanced","name":"高级主题","position":1}]}</script><link rel=stylesheet href=/try-docusaurus/assets/css/styles.b92695c3.css /><script src=/try-docusaurus/assets/js/runtime~main.3c3c7a0a.js defer></script><script src=/try-docusaurus/assets/js/main.d9eb7c8b.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/try-docusaurus/img/logo.svg /><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/try-docusaurus/><div class=navbar__logo><img src=/try-docusaurus/img/logo.svg alt="GitHub Release Manager Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/try-docusaurus/img/logo.svg alt="GitHub Release Manager Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">GitHub Release Manager</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/try-docusaurus/docs/intro>文档</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/nostalgia296/asd target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/try-docusaurus/docs/intro><span title="GitHub Release Manager 简介" class=linkLabel_WmDU>GitHub Release Manager 简介</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/try-docusaurus/docs/installation><span title=安装指南 class=linkLabel_WmDU>安装指南</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/try-docusaurus/docs/configuration><span title=配置说明 class=linkLabel_WmDU>配置说明</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/try-docusaurus/docs/usage><span title=使用指南 class=linkLabel_WmDU>使用指南</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/try-docusaurus/docs/commands><span title=命令参考 class=linkLabel_WmDU>命令参考</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current=page href=/try-docusaurus/docs/advanced><span title=高级主题 class=linkLabel_WmDU>高级主题</span></a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/try-docusaurus/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>高级主题</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>高级主题</h1></header>
<p>本文档介绍 GitHub Release Manager 的高级用法和最佳实践。</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=高级功能>高级功能<a href=#高级功能 class=hash-link aria-label="Direct link to 高级功能" title="Direct link to 高级功能" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=通配符匹配>通配符匹配<a href=#通配符匹配 class=hash-link aria-label="Direct link to 通配符匹配" title="Direct link to 通配符匹配" translate=no>​</a></h3>
<p>工具支持标准的 Unix 通配符模式：</p>
<ul>
<li class=""><code>*</code> - 匹配任意数量的字符</li>
<li class=""><code>?</code> - 匹配单个字符</li>
<li class=""><code>[abc]</code> - 匹配方括号内的任意字符</li>
<li class=""><code>[a-z]</code> - 匹配指定范围内的任意字符</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=示例>示例<a href=#示例 class=hash-link aria-label="Direct link to 示例" title="Direct link to 示例" translate=no>​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 匹配所有 .zip 文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload *.zip</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 匹配以 backup- 开头，日期为 2024-01-xx 的文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload backup-2024-01-*.zip</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 匹配单个字符变化</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload file?.txt  </span><span class="token comment" style=color:#999988;font-style:italic># 匹配 file1.txt, file2.txt 等</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 匹配方括号内的任意字符</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload file</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>123</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">.txt  </span><span class="token comment" style=color:#999988;font-style:italic># 匹配 file1.txt, file2.txt, file3.txt</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=批量操作优化>批量操作优化<a href=#批量操作优化 class=hash-link aria-label="Direct link to 批量操作优化" title="Direct link to 批量操作优化" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=1-大批量文件处理>1. 大批量文件处理<a href=#1-大批量文件处理 class=hash-link aria-label="Direct link to 1. 大批量文件处理" title="Direct link to 1. 大批量文件处理" translate=no>​</a></h4>
<p>处理大量文件时（> 100 个），建议分批处理：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># batch_upload.sh</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 每批 50 个文件分批上传</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>FILES</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">*.zip</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>BATCH_SIZE</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>50</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token variable punctuation" style=color:#393A34>((</span><span class="token variable" style=color:#36acaa>i</span><span class="token variable operator" style=color:#393A34>=</span><span class="token variable number" style=color:#36acaa>0</span><span class="token variable punctuation" style=color:#393A34>;</span><span class="token variable" style=color:#36acaa> i</span><span class="token variable operator" style=color:#393A34>&lt;</span><span class="token variable" style=color:#36acaa>${#FILES[@]}</span><span class="token variable punctuation" style=color:#393A34>;</span><span class="token variable" style=color:#36acaa> i</span><span class="token variable operator" style=color:#393A34>+=</span><span class="token variable" style=color:#36acaa>BATCH_SIZE</span><span class="token variable punctuation" style=color:#393A34>))</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token assign-left variable" style=color:#36acaa>BATCH</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token variable" style=color:#36acaa>${FILES</span><span class="token variable punctuation" style=color:#393A34>[</span><span class="token variable" style=color:#36acaa>@</span><span class="token variable punctuation" style=color:#393A34>]</span><span class="token variable operator" style=color:#393A34>:</span><span class="token variable" style=color:#36acaa>i</span><span class="token variable operator" style=color:#393A34>:</span><span class="token variable" style=color:#36acaa>BATCH_SIZE}</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    ./manage upload </span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>${BATCH</span><span class="token string variable punctuation" style=color:#393A34>[</span><span class="token string variable" style=color:#36acaa>@</span><span class="token string variable punctuation" style=color:#393A34>]</span><span class="token string variable" style=color:#36acaa>}</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>done</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=2-并行处理>2. 并行处理<a href=#2-并行处理 class=hash-link aria-label="Direct link to 2. 并行处理" title="Direct link to 2. 并行处理" translate=no>​</a></h4>
<p>使用 GNU parallel 进行并行上传：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 安装 parallel（Ubuntu/Debian）</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>sudo</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>apt-get</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> parallel</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 并行上传（最多 4 个并发）</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>ls</span><span class="token plain"> *.zip </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> parallel </span><span class="token parameter variable" style=color:#36acaa>-j</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> ./manage upload </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=3-错误处理和重试>3. 错误处理和重试<a href=#3-错误处理和重试 class=hash-link aria-label="Direct link to 3. 错误处理和重试" title="Direct link to 3. 错误处理和重试" translate=no>​</a></h4>
<p>在脚本中处理错误：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 上传文件，失败时重试 3 次</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function-name function" style=color:#d73a49>upload_with_retry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>file</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>$1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>retries</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>3</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>count</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>until</span><span class="token plain"> ./manage upload </span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>$file</span><span class="token string" style=color:#e3116c>"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token variable punctuation" style=color:#393A34>((</span><span class="token variable" style=color:#36acaa>count</span><span class="token variable operator" style=color:#393A34>++</span><span class="token variable punctuation" style=color:#393A34>))</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$count</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-ge</span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$retries</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>then</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"上传 </span><span class="token string variable" style=color:#36acaa>$file</span><span class="token string" style=color:#e3116c> 失败!"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token builtin class-name">return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>fi</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"重试 </span><span class="token string variable" style=color:#36acaa>$count</span><span class="token string" style=color:#e3116c>/</span><span class="token string variable" style=color:#36acaa>$retries</span><span class="token string" style=color:#e3116c>..."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>sleep</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>done</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 上传所有 zip 文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token for-or-select variable" style=color:#36acaa>file</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>in</span><span class="token plain"> *.zip</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    upload_with_retry </span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>$file</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>done</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=安全性最佳实践>安全性最佳实践<a href=#安全性最佳实践 class=hash-link aria-label="Direct link to 安全性最佳实践" title="Direct link to 安全性最佳实践" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=1-token-安全管理>1. Token 安全管理<a href=#1-token-安全管理 class=hash-link aria-label="Direct link to 1. Token 安全管理" title="Direct link to 1. Token 安全管理" translate=no>​</a></h3>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=方案-a使用-token-文件推荐>方案 A：使用 Token 文件（推荐）<a href=#方案-a使用-token-文件推荐 class=hash-link aria-label="Direct link to 方案 A：使用 Token 文件（推荐）" title="Direct link to 方案 A：使用 Token 文件（推荐）" translate=no>​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 1. 创建 token 文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"ghp_your_token_here"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> ~/.github_token</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>chmod</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>600</span><span class="token plain"> ~/.github_token</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 2. 设置环境变量</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>GITHUB_TOKEN_FILE</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"</span><span class="token string environment constant" style=color:#36acaa>$HOME</span><span class="token string" style=color:#e3116c>/.github_token"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 3. 验证权限</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>ls</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-la</span><span class="token plain"> ~/.github_token</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 应该显示：-rw-------</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=方案-b使用密钥管理服务>方案 B：使用密钥管理服务<a href=#方案-b使用密钥管理服务 class=hash-link aria-label="Direct link to 方案 B：使用密钥管理服务" title="Direct link to 方案 B：使用密钥管理服务" translate=no>​</a></h4>
<p>在 CI/CD 环境中使用密钥管理：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># GitHub Actions</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>GITHUB_TOKEN</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>${{ secrets.GITHUB_TOKEN }</span><span class="token string" style=color:#e3116c>}"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># GitLab CI</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>GITHUB_TOKEN</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"</span><span class="token string variable" style=color:#36acaa>$GITHUB_TOKEN</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># AWS Secrets Manager</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>GITHUB_TOKEN</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable" style=color:#36acaa>aws secretsmanager get-secret-value </span><span class="token variable punctuation" style=color:#393A34>\</span><span class="token variable" style=color:#36acaa></span><br/></span><span class=token-line style=color:#393A34><span class="token variable" style=color:#36acaa>  --secret-id github-token </span><span class="token variable punctuation" style=color:#393A34>\</span><span class="token variable" style=color:#36acaa></span><br/></span><span class=token-line style=color:#393A34><span class="token variable" style=color:#36acaa>  </span><span class="token variable parameter variable" style=color:#36acaa>--query</span><span class="token variable" style=color:#36acaa> SecretString </span><span class="token variable punctuation" style=color:#393A34>\</span><span class="token variable" style=color:#36acaa></span><br/></span><span class=token-line style=color:#393A34><span class="token variable" style=color:#36acaa>  </span><span class="token variable parameter variable" style=color:#36acaa>--output</span><span class="token variable" style=color:#36acaa> text</span><span class="token variable" style=color:#36acaa>)</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=方案-c使用-gnu-pass>方案 C：使用 GNU Pass<a href=#方案-c使用-gnu-pass class=hash-link aria-label="Direct link to 方案 C：使用 GNU Pass" title="Direct link to 方案 C：使用 GNU Pass" translate=no>​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 安装 pass</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>sudo</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>apt-get</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>install</span><span class="token plain"> pass</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 存储 token</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">pass insert github-token</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 输入: ghp_your_token_here</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 使用 token</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>GITHUB_TOKEN</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable" style=color:#36acaa>pass github-token</span><span class="token variable" style=color:#36acaa>)</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=2-配置文件权限>2. 配置文件权限<a href=#2-配置文件权限 class=hash-link aria-label="Direct link to 2. 配置文件权限" title="Direct link to 2. 配置文件权限" translate=no>​</a></h3>
<p>始终设置配置文件的权限：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 创建配置文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage config init</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 检查当前权限</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>ls</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-la</span><span class="token plain"> .manage_config.json</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 设置安全权限（仅所有者可读写）</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>chmod</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>600</span><span class="token plain"> .manage_config.json</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 验证权限</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>ls</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-la</span><span class="token plain"> .manage_config.json</span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 应该显示：-rw-------</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=3-避免在命令行中暴露-token>3. 避免在命令行中暴露 Token<a href=#3-避免在命令行中暴露-token class=hash-link aria-label="Direct link to 3. 避免在命令行中暴露 Token" title="Direct link to 3. 避免在命令行中暴露 Token" translate=no>​</a></h3>
<p><strong>不推荐</strong>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 不要在命令行中直接写 token</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage config </span><span class="token builtin class-name">set</span><span class="token plain"> token ghp_my_token_here  </span><span class="token comment" style=color:#999988;font-style:italic># 会在 shell 历史中保存</span><br/></span></code></pre></div></div>
<p><strong>推荐</strong>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 方法 1：从文件读取</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> ghp_my_token_here </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> token_file</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage config </span><span class="token builtin class-name">set</span><span class="token plain"> token </span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable function" style=color:#d73a49>cat</span><span class="token variable" style=color:#36acaa> token_file</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>rm</span><span class="token plain"> token_file</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 方法 2：环境变量</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>GITHUB_TOKEN</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"ghp_my_token_here"</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=4-审计和日志>4. 审计和日志<a href=#4-审计和日志 class=hash-link aria-label="Direct link to 4. 审计和日志" title="Direct link to 4. 审计和日志" translate=no>​</a></h3>
<p>设置适当的日志级别进行审计：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 记录所有操作</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>MANAGE_LOG_LEVEL</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic># DEBUG 级别</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload *.zip </span><span class="token operator file-descriptor important" style=color:#393A34>2</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> operation.log</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 查看日志</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>cat</span><span class="token plain"> operation.log</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=cicd-集成高级用法>CI/CD 集成高级用法<a href=#cicd-集成高级用法 class=hash-link aria-label="Direct link to CI/CD 集成高级用法" title="Direct link to CI/CD 集成高级用法" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=github-actions-完整示例>GitHub Actions 完整示例<a href=#github-actions-完整示例 class=hash-link aria-label="Direct link to GitHub Actions 完整示例" title="Direct link to GitHub Actions 完整示例" translate=no>​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Release Management</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>on</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>push</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>tags</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'v*'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>workflow_dispatch</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>inputs</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token key atrule" style=color:#00a4db>version</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>description</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'版本号'</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>required</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token boolean important" style=color:#36acaa>true</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>type</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> string</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>env</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>GITHUB_TOKEN</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> $</span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> secrets.GITHUB_TOKEN </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>GITHUB_OWNER</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> $</span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> github.repository_owner </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>GITHUB_REPO</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> $</span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> github.event.repository.name </span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>jobs</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>build-and-upload</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>runs-on</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">latest</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>permissions</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token key atrule" style=color:#00a4db>contents</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> write</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>steps</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>uses</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> actions/checkout@v4</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Install dependencies</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>run</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>|</span><span class="token scalar string" style=color:#e3116c></span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>          sudo apt-get update</span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>          sudo apt-get install -y libcurl4-openssl-dev libjson-c-dev</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Compile GitHub Release Manager</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>run</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>|</span><span class="token scalar string" style=color:#e3116c></span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>          gcc manage.c -o manage $(pkg-config --cflags --libs libcurl json-c)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Build application</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>run</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>|</span><span class="token scalar string" style=color:#e3116c></span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>          make build VERSION=${{ github.event.inputs.version || github.ref_name }}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Create Release</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>if</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> github.event_name == 'push'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>run</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>|</span><span class="token scalar string" style=color:#e3116c></span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>          ./manage create-release ${{ github.ref_name }} \</span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>            --name "Release ${{ github.ref_name }}" \</span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>            --description "Auto-generated release" \</span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>            build/*</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> Upload files</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>if</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> github.event_name == 'workflow_dispatch'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>run</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>|</span><span class="token scalar string" style=color:#e3116c></span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>          ./manage upload build/*</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> </span><span class="token key atrule" style=color:#00a4db>name</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> List Release files</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token key atrule" style=color:#00a4db>run</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>|</span><span class="token scalar string" style=color:#e3116c></span><br/></span><span class=token-line style=color:#393A34><span class="token scalar string" style=color:#e3116c>          ./manage list</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=gitlab-ci-完整示例>GitLab CI 完整示例<a href=#gitlab-ci-完整示例 class=hash-link aria-label="Direct link to GitLab CI 完整示例" title="Direct link to GitLab CI 完整示例" translate=no>​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token key atrule" style=color:#00a4db>stages</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> build</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> release</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>variables</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>GITHUB_TOKEN</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> $GITHUB_TOKEN</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>GITHUB_OWNER</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"your-username"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>GITHUB_REPO</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"your-repo"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>before_script</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> apt</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">get update </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">qq</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> apt</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">get install </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">y build</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">essential libcurl4</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">openssl</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">dev libjson</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">c</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">dev</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> gcc manage.c </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">o manage $(pkg</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">config </span><span class="token punctuation" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">cflags </span><span class="token punctuation" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">libs libcurl json</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">c)</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>build</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>stage</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> build</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>script</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> make build VERSION=$CI_COMMIT_TAG</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>artifacts</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>paths</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">      </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> build/</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token key atrule" style=color:#00a4db>expire_in</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> 1 week</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>create:release</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>stage</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> release</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>only</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> tags</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>script</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> ./manage create</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">release $CI_COMMIT_TAG \</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">name "Release $CI_COMMIT_TAG" \</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain">description "Release from GitLab CI" \</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        build/*</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token key atrule" style=color:#00a4db>upload:artifacts</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>stage</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"> release</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>only</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> main</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token key atrule" style=color:#00a4db>script</span><span class="token punctuation" style=color:#393A34>:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>-</span><span class="token plain"> ./manage upload build/*</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=jenkins-pipeline-示例>Jenkins Pipeline 示例<a href=#jenkins-pipeline-示例 class=hash-link aria-label="Direct link to Jenkins Pipeline 示例" title="Direct link to Jenkins Pipeline 示例" translate=no>​</a></h3>
<div class="language-groovy codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-groovy codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">pipeline {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    agent any</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    environment {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        GITHUB_TOKEN = credentials('github-token')</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        GITHUB_OWNER = 'your-username'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        GITHUB_REPO = 'your-repo'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    stages {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        stage('Build') {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            steps {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                sh 'make build'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        stage('Compile Release Manager') {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            steps {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                sh '''</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                    gcc manage.c -o manage $(pkg-config --cflags --libs libcurl json-c)</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                '''</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        stage('Create Release') {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            when {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                buildingTag()</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            steps {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                sh '''</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                    ./manage create-release ${TAG_NAME} \</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                        --name "Release ${TAG_NAME}" \</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                        build/*</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                '''</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        stage('Upload Artifacts') {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            steps {</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">                sh './manage upload build/*'</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">            }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    }</span><br/></span><span class=token-line style=color:#393A34><span class="token plain">}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=性能优化>性能优化<a href=#性能优化 class=hash-link aria-label="Direct link to 性能优化" title="Direct link to 性能优化" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=1-启用-http2>1. 启用 HTTP/2<a href=#1-启用-http2 class=hash-link aria-label="Direct link to 1. 启用 HTTP/2" title="Direct link to 1. 启用 HTTP/2" translate=no>​</a></h3>
<p>编译时启用 HTTP/2（如果 libcurl 支持）：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">gcc manage.c </span><span class="token parameter variable" style=color:#36acaa>-o</span><span class="token plain"> manage </span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable" style=color:#36acaa>pkg-config </span><span class="token variable parameter variable" style=color:#36acaa>--cflags</span><span class="token variable" style=color:#36acaa> </span><span class="token variable parameter variable" style=color:#36acaa>--libs</span><span class="token variable" style=color:#36acaa> libcurl json-c</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-DCURL_HTTP_VERSION_2TLS</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=2-调整缓冲区大小>2. 调整缓冲区大小<a href=#2-调整缓冲区大小 class=hash-link aria-label="Direct link to 2. 调整缓冲区大小" title="Direct link to 2. 调整缓冲区大小" translate=no>​</a></h3>
<p>修改源代码中的缓冲区大小（如果需要上传超大文件）：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 在 manage.c 中找到以下行并调整</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>UPLOAD_BUFFER_SIZE</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression number" style=color:#36acaa>8192</span><span class="token macro property expression" style=color:#36acaa>  </span><span class="token macro property comment" style=color:#999988;font-style:italic>// 增大缓冲区</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=3-网络优化>3. 网络优化<a href=#3-网络优化 class=hash-link aria-label="Direct link to 3. 网络优化" title="Direct link to 3. 网络优化" translate=no>​</a></h3>
<p>在高延迟网络环境中：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 减少重试延迟（修改源代码中的 baseDelay）</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">static int baseDelay </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  // 从 </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> 秒开始</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 增加超时时间</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 在 curl 设置中添加</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">curl_easy_setopt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">curl, CURLOPT_TIMEOUT, 300L</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  // </span><span class="token number" style=color:#36acaa>5</span><span class="token plain"> 分钟超时</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=4-压缩文件>4. 压缩文件<a href=#4-压缩文件 class=hash-link aria-label="Direct link to 4. 压缩文件" title="Direct link to 4. 压缩文件" translate=no>​</a></h3>
<p>上传前压缩大文件：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># compress-and-upload.sh</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 压缩文件（使用并行压缩）</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>tar</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-I</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>'pigz -p 4'</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-cf</span><span class="token plain"> archive.tar.gz data/</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 上传压缩文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload archive.tar.gz</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=故障排除>故障排除<a href=#故障排除 class=hash-link aria-label="Direct link to 故障排除" title="Direct link to 故障排除" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=问题-1上传速度慢>问题 1：上传速度慢<a href=#问题-1上传速度慢 class=hash-link aria-label="Direct link to 问题 1：上传速度慢" title="Direct link to 问题 1：上传速度慢" translate=no>​</a></h3>
<p><strong>原因</strong>：网络延迟或带宽限制</p>
<p><strong>解决方案</strong>：</p>
<ol>
<li class="">压缩文件</li>
<li class="">使用多线程上传工具</li>
<li class="">选择就近的 GitHub 数据中心</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=问题-2频繁触发-api-限制>问题 2：频繁触发 API 限制<a href=#问题-2频繁触发-api-限制 class=hash-link aria-label="Direct link to 问题 2：频繁触发 API 限制" title="Direct link to 问题 2：频繁触发 API 限制" translate=no>​</a></h3>
<p><strong>原因</strong>：批量操作过于频繁</p>
<p><strong>解决方案</strong>：</p>
<ol>
<li class="">增加延迟（工具已自动添加 0.1 秒延迟）</li>
<li class="">减少并发数</li>
<li class="">联系 GitHub 提高 API 限制</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=问题-3大文件上传失败>问题 3：大文件上传失败<a href=#问题-3大文件上传失败 class=hash-link aria-label="Direct link to 问题 3：大文件上传失败" title="Direct link to 问题 3：大文件上传失败" translate=no>​</a></h3>
<p><strong>原因</strong>：网络超时或文件大小限制</p>
<p><strong>解决方案</strong>：</p>
<ol>
<li class="">分割大文件：<code>split -b 100M largefile.bin part-</code></li>
<li class="">增加超时时间</li>
<li class="">确保文件 &lt; 2GB（GitHub 限制）</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=问题-4token-权限不足>问题 4：Token 权限不足<a href=#问题-4token-权限不足 class=hash-link aria-label="Direct link to 问题 4：Token 权限不足" title="Direct link to 问题 4：Token 权限不足" translate=no>​</a></h3>
<p><strong>错误</strong>：<code>404 Not Found</code> 或 <code>403 Forbidden</code></p>
<p><strong>解决方案</strong>：</p>
<ol>
<li class="">检查 token 是否有 <code>repo</code> 作用域</li>
<li class="">检查仓库是否存在</li>
<li class="">检查是否有写入权限</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=问题-5release-不存在>问题 5：Release 不存在<a href=#问题-5release-不存在 class=hash-link aria-label="Direct link to 问题 5：Release 不存在" title="Direct link to 问题 5：Release 不存在" translate=no>​</a></h3>
<p><strong>错误</strong>：<code>未找到tag为 "v1.0.0" 的release</code></p>
<p><strong>解决方案</strong>：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 先创建 Release</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage create-release v1.0.0</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 然后上传文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload *.zip</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=监控和日志>监控和日志<a href=#监控和日志 class=hash-link aria-label="Direct link to 监控和日志" title="Direct link to 监控和日志" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=详细日志>详细日志<a href=#详细日志 class=hash-link aria-label="Direct link to 详细日志" title="Direct link to 详细日志" translate=no>​</a></h3>
<p>启用调试日志：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 设置日志级别为 DEBUG</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>MANAGE_LOG_LEVEL</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 重定向日志到文件</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">./manage upload *.zip </span><span class="token operator file-descriptor important" style=color:#393A34>2</span><span class="token operator" style=color:#393A34>></span><span class="token plain"> debug.log</span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 查看实时日志</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>tail</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-f</span><span class="token plain"> debug.log</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=json-日志格式>JSON 日志格式<a href=#json-日志格式 class=hash-link aria-label="Direct link to JSON 日志格式" title="Direct link to JSON 日志格式" translate=no>​</a></h3>
<p>对于日志收集系统，可以修改源代码输出 JSON 格式：</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 修改 log_message 函数输出 JSON</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>fprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token constant" style=color:#36acaa>stderr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"{\"level\":\"%s\",\"message\":\""</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> level_strs</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">level</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>vfprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token constant" style=color:#36acaa>stderr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fmt</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> args</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>fprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token constant" style=color:#36acaa>stderr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"\"}\n"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=监控脚本>监控脚本<a href=#监控脚本 class=hash-link aria-label="Direct link to 监控脚本" title="Direct link to 监控脚本" translate=no>​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># monitor.sh</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token assign-left variable" style=color:#36acaa>LOG_FILE</span><span class="token operator" style=color:#393A34>=</span><span class="token string" style=color:#e3116c>"/var/log/github-release-manager.log"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 监控上传操作</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function-name function" style=color:#d73a49>upload_and_log</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>files</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>$1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style=color:#36acaa>timestamp</span><span class="token operator" style=color:#393A34>=</span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable function" style=color:#d73a49>date</span><span class="token variable" style=color:#36acaa> </span><span class="token variable string" style=color:#e3116c>'+%Y-%m-%d %H:%M:%S'</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"[</span><span class="token string variable" style=color:#36acaa>$timestamp</span><span class="token string" style=color:#e3116c>] Starting upload: </span><span class="token string variable" style=color:#36acaa>$files</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>>></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$LOG_FILE</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> ./manage upload </span><span class="token variable" style=color:#36acaa>$files</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>then</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"[</span><span class="token string variable" style=color:#36acaa>$timestamp</span><span class="token string" style=color:#e3116c>] Upload success: </span><span class="token string variable" style=color:#36acaa>$files</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>>></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$LOG_FILE</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token builtin class-name">return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"[</span><span class="token string variable" style=color:#36acaa>$timestamp</span><span class="token string" style=color:#e3116c>] Upload failed: </span><span class="token string variable" style=color:#36acaa>$files</span><span class="token string" style=color:#e3116c>"</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>>></span><span class="token plain"> </span><span class="token variable" style=color:#36acaa>$LOG_FILE</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token builtin class-name">return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>fi</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 使用示例</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">upload_and_log </span><span class="token string" style=color:#e3116c>"*.zip"</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=自定义和扩展>自定义和扩展<a href=#自定义和扩展 class=hash-link aria-label="Direct link to 自定义和扩展" title="Direct link to 自定义和扩展" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=添加新功能>添加新功能<a href=#添加新功能 class=hash-link aria-label="Direct link to 添加新功能" title="Direct link to 添加新功能" translate=no>​</a></h3>
<p>要添加新命令，需要：</p>
<ol>
<li class="">实现功能函数：</li>
</ol>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 在 manage.c 中添加</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>static</span><span class="token plain"> ErrorCode </span><span class="token function" style=color:#d73a49>myNewCommand</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">param</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> Config </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">config</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 实现功能</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> ERR_OK</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<ol start=2>
<li class="">在主函数中添加命令处理：</li>
</ol>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>// 在 main 函数的命令处理部分</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>strcmp</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">command</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"my-command"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// 调用你的函数</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br/></span></code></pre></div></div>
<ol start=3>
<li class="">更新帮助信息（<code>showUsage</code> 和 <code>showDetailedUsage</code> 函数）</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=编译选项>编译选项<a href=#编译选项 class=hash-link aria-label="Direct link to 编译选项" title="Direct link to 编译选项" translate=no>​</a></h3>
<p>编译时添加自定义选项：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic># 启用所有警告</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">gcc manage.c </span><span class="token parameter variable" style=color:#36acaa>-o</span><span class="token plain"> manage </span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable" style=color:#36acaa>pkg-config </span><span class="token variable parameter variable" style=color:#36acaa>--cflags</span><span class="token variable" style=color:#36acaa> </span><span class="token variable parameter variable" style=color:#36acaa>--libs</span><span class="token variable" style=color:#36acaa> libcurl json-c</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-Wall</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-Wextra</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-Wpedantic</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-O2</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic># 静态链接（生成独立可执行文件，不推荐，但可能在某些环境需要）</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">gcc manage.c </span><span class="token parameter variable" style=color:#36acaa>-o</span><span class="token plain"> manage </span><span class="token variable" style=color:#36acaa>$(</span><span class="token variable" style=color:#36acaa>pkg-config </span><span class="token variable parameter variable" style=color:#36acaa>--cflags</span><span class="token variable" style=color:#36acaa> </span><span class="token variable parameter variable" style=color:#36acaa>--libs</span><span class="token variable" style=color:#36acaa> libcurl json-c</span><span class="token variable" style=color:#36acaa>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token parameter variable" style=color:#36acaa>-static</span><span class="token plain"> </span><span class="token parameter variable" style=color:#36acaa>-O2</span><br/></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/try-docusaurus/docs/commands><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>命令参考</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#高级功能 class="table-of-contents__link toc-highlight">高级功能</a><ul><li><a href=#通配符匹配 class="table-of-contents__link toc-highlight">通配符匹配</a><li><a href=#批量操作优化 class="table-of-contents__link toc-highlight">批量操作优化</a></ul><li><a href=#安全性最佳实践 class="table-of-contents__link toc-highlight">安全性最佳实践</a><ul><li><a href=#1-token-安全管理 class="table-of-contents__link toc-highlight">1. Token 安全管理</a><li><a href=#2-配置文件权限 class="table-of-contents__link toc-highlight">2. 配置文件权限</a><li><a href=#3-避免在命令行中暴露-token class="table-of-contents__link toc-highlight">3. 避免在命令行中暴露 Token</a><li><a href=#4-审计和日志 class="table-of-contents__link toc-highlight">4. 审计和日志</a></ul><li><a href=#cicd-集成高级用法 class="table-of-contents__link toc-highlight">CI/CD 集成高级用法</a><ul><li><a href=#github-actions-完整示例 class="table-of-contents__link toc-highlight">GitHub Actions 完整示例</a><li><a href=#gitlab-ci-完整示例 class="table-of-contents__link toc-highlight">GitLab CI 完整示例</a><li><a href=#jenkins-pipeline-示例 class="table-of-contents__link toc-highlight">Jenkins Pipeline 示例</a></ul><li><a href=#性能优化 class="table-of-contents__link toc-highlight">性能优化</a><ul><li><a href=#1-启用-http2 class="table-of-contents__link toc-highlight">1. 启用 HTTP/2</a><li><a href=#2-调整缓冲区大小 class="table-of-contents__link toc-highlight">2. 调整缓冲区大小</a><li><a href=#3-网络优化 class="table-of-contents__link toc-highlight">3. 网络优化</a><li><a href=#4-压缩文件 class="table-of-contents__link toc-highlight">4. 压缩文件</a></ul><li><a href=#故障排除 class="table-of-contents__link toc-highlight">故障排除</a><ul><li><a href=#问题-1上传速度慢 class="table-of-contents__link toc-highlight">问题 1：上传速度慢</a><li><a href=#问题-2频繁触发-api-限制 class="table-of-contents__link toc-highlight">问题 2：频繁触发 API 限制</a><li><a href=#问题-3大文件上传失败 class="table-of-contents__link toc-highlight">问题 3：大文件上传失败</a><li><a href=#问题-4token-权限不足 class="table-of-contents__link toc-highlight">问题 4：Token 权限不足</a><li><a href=#问题-5release-不存在 class="table-of-contents__link toc-highlight">问题 5：Release 不存在</a></ul><li><a href=#监控和日志 class="table-of-contents__link toc-highlight">监控和日志</a><ul><li><a href=#详细日志 class="table-of-contents__link toc-highlight">详细日志</a><li><a href=#json-日志格式 class="table-of-contents__link toc-highlight">JSON 日志格式</a><li><a href=#监控脚本 class="table-of-contents__link toc-highlight">监控脚本</a></ul><li><a href=#自定义和扩展 class="table-of-contents__link toc-highlight">自定义和扩展</a><ul><li><a href=#添加新功能 class="table-of-contents__link toc-highlight">添加新功能</a><li><a href=#编译选项 class="table-of-contents__link toc-highlight">编译选项</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>文档</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/try-docusaurus/docs/intro>快速开始</a><li class=footer__item><a class=footer__link-item href=/try-docusaurus/docs/installation>安装</a><li class=footer__item><a class=footer__link-item href=/try-docusaurus/docs/usage>使用指南</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>社区</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/nostalgia296/asd/issues target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub Issues<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>更多</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/nostalgia296/asd target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub 仓库<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright © 2025 GitHub Release Manager. Built with Docusaurus.</div></div></div></footer></div></body>